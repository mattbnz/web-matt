---
title: Calling time on DNSSEC
subtitle: The costs exceed the gains
date: 2023-05-31T08:14:32+12:00
draft: true

categories:
  - Technology
---

I'm calling time on DNSSEC. Last week I began removing it from the few personal zones I had signed as part of a planned migration of my DNS hosting infrastructure. Then starting on Monday the .nz ccTLD experienced a multi-day availability incident triggered by the annual DNSSEC key rotation process. This broke several of my zones (unsigned or not), which led me to say [very unkind things](https://mastodon.nz/@mattb/110454220262285434) about DNSSEC on Mastodon and now I feel compelled to more completely explain my thinking:

**For almost all domains and use-cases, the costs and risks of deploying DNSSEC outweigh the benefits it provides. Don't bother signing your zones.**

The .nz incident, while topical, is not the motivation or the trigger for this conclusion. Had it been a novel incident, it would still have been annoying, but novel incidents are how we learn so I have a small tolerance for them. The problem with DNSSEC is precisely that this incident was not novel, just the latest in a [long and growing list](https://ianix.com/pub/dnssec-outages.html).

It's a clear pattern. DNSSEC is complex and risky to deploy. Choosing to sign your zone will almost inevitably mean that you will experience lower availability for your domain over time than if you leave it unsigned. Even if you have a team of DNS experts maintaining your zone and DNS infrastructure, the risk of routine operational tasks triggering a loss of availability (unrelated to any attempted attacks that DNSSEC may thwart) is very high - almost guaranteed to occur. Worse, because of the nature of DNS and DNSSEC these incidents will tend to be prolonged and out of your control to remediate in a timely fashion.

The only benefit you get in return for accepting this almost certain reduction in availability is trust in the integrity of the DNS data you receive. Trusted DNS data that is then used by your application to communicate across an untrusted network layer. An untrusted network layer which is almost certainly protected by TLS, which today provides a more comprehensive and trustworthy set of security guarantees than DNSSEC is capable of, and provides those guarantees even if your DNS data is untrusted and poisoned.

In summary, in our modern world where TLS is ubiquitous, DNSSEC provides only a thin layer of redundant protection on top of the comprehensive guarantees provided by TLS, but adds significant operational complexity, cost and a high likelihood of lowered availability.

In an ideal world, where the deployment cost of DNSSEC was low and the risk of DNSSEC-induced outages was low, it would absolutely be desirable to have redundancy in our layers of protection. In the real world, with the DNSSEC protocol we have today, the choice to avoid its complexity and rely on TLS is not at all painful or risky to make.

**Ignore DNSSEC and invest the time and resources you would have spent deploying it improving your TLS key and certificate management.**

Ironically, the one use-case where I think a valid counter-argument for this position can be made is TLDs (including ccTLDs such as .nz). Warts and all DNSSEC is an Internet Standard, and as infrastructure providers, TLDs have an obligation to support its use. Unfortunately this means that everyone has to bear the costs, complexities and availability risks that DNSSEC burdens these operators with. We can't avoid that fact, but we can avoid creating further costs, complexities and risks further by choosing not to deploy DNSSEC on the rest of our domains.


### But doesn't TLS rely on evil CAs?

Historically the state of security at the web application (HTTP) layer has been messy and unclear which increased the value of providing integrity at the DNS layer. SSL certificates were expensive and hard to obtain, the CA ecosystem was a cesspit of poor practices and unclear trust relationships, the appeal of being able to bypass these risks by trusting the integrity of the DNS layer to provide the necessary data to then secure the application layer was compelling.

And yet, despite the compelling potential benefits that widespread DNSSEC deployment promised, what we have observed over the past 10 years instead is that DNSSEC deployment has languished, while the web security ecosystem has flourished and improved in leaps and bounds to the point where an end-user today can have significant confidence that their HTTPS sessions are secure in all dimensions regardless of whether or not DNSSEC is in use. The improvements in web security have eliminated all the benefits DNSSEC provides. A choice to deploy DNSSEC to protect HTTP traffic today is a choice to take on additional costs to reduce your availability without improving security.

Benefits of investing in a single crypto ecosystem.


Buying in to this argument requires accepting the fundamental role of the CA authorities, which as noted above has historically been garbage and not desirable. Many have argued that the DNS trust hierarchy is superior to the CA ecosystem for this reason. I am not convinced.

For one, by nature of being a hierarchy their are significant single points of failure and trust that must be continuously monitored and verified to have confidence in the overall system.

Secondly, the expensse and effort involved in providing that oversight and audit function would be better applied to one ecosystem, rather than two.


### TLS is not ubiquitous for non-HTTP applications

For non-HTTP protocols the story is slightly more complex as there has not been as much evolution and development of the security infrastructure, it is claimed that DNSSEC still has worthwhile benefits to offer here that might justify the costs of deployment.

I think the argument is actually the other direction - the costs of DNSSEC deployment are fixed regardless of how many protocols you are using it to protect, without the benefits of protecting HTTP via DNSSEC these non-HTTP protocols must now bear the full cost of demonstrating that the benefits they can gain outweigh the costs of deployment - keeping in mind that a DNSSEC error is likely to impact an entire zone, causing availability issue for your (typically more valuable) web traffic even if you were only aiming to protect your non-HTTP resources with DNSSEC.

From this perspective, taking the time/effort that would be spent attempting to reliably deploy DNSSEC to protect non-HTTP applications would be much better spent enabling those applications to instead benefit from the SSL ecosystem improvements. MTA-STS provides a clear worked example of the feasibility of this approach, and while the full set of benefits and protections are not yet available, there's significant protection already in place in the ecosystem that you piggy-back on and the collective effort saved from not deploying DNSSEC would go a long way to bringing web-equivalent protections to these additional applications.


### Better Software will save us

Another common argument is that the current DNSSEC costs are simply teething problems that will reduce as the software and tooling matures, or that you can avoid by outsourcing the management and complexity to larger providers to take care of for you.

I don't find these arguments compelling, DNSSEC is already more than 15 years old as a protocol which is plenty of time for improvements and cost reductions in tooling and software to occur. The fact that these improvements have only been piecemeal and deployment rate continues to languish, is a strong refutation of this argument - I see nothing on the horizon that is likely to change or alter this state.

The issue with outsourcing the management and complexity to a trusted piece of software or provider is that its simply delaying the inevitable. You likely can get years of trouble-free operation with this approach until you want to change software or provider at which point you run head-first into the complexity and risks, and worse it's a novel and unfamiliar situation, further increasing the risk of error and the cost of migration. Creating this sort of software/provider lock-in to mitigate the downsides of the DNSSEC protocol is not a desirable outcome.

### Summing up

For the vast majority of domains and use-cases there is simply no net benefit to deploying DNSSEC in 2023. I'd even go so far as to say that if you've already signed your zones, you should (carefully) move them back to being unsigned - you'll reduce the complexity of your operating environment and lower your risk of DNS availability outages. Your users will thank you.

The threats that DNSSEC prevents against are already amply defended by the now mature and still improving TLS ecosystem at the application layer, and investing in further improvements here carries far more return than deployment of DNSSEC.

For TLDs, like .nz whose outage triggered this post, DNSSEC is not going anywhere and investment in mitigating its complexities and risks is an unfortunate burden that must be shouldered. While the full incident report of what went wrong with .nz is not yet available, from the interim report already hints at some rich learnings to be had and it will be important for InternetNZ to publish a full and comprehensive review so that the learnings and improvements this latest incident can drive can be fully realised. Both in .nz and by other operators stuck with the unenviable task of trying to safely operate DNSSEC.

## Postscript

After taking a few days to draft and edit this post, I've just stumbled across a [presentation](https://ripe86.ripe.net/presentations/51-2023-05-23-dnssec.pdf) from the well respected Geoff Huston at last weeks RIPE86 meeting. I've only had time to skim the [slides](https://ripe86.ripe.net/presentations/51-2023-05-23-dnssec.pdf) ([video here](https://ripe86.ripe.net/archives/video/1018/)) - they don't seem to disagree with my thinking regarding the futility of the current state of DNSSEC, but also contain some interesting ideas for what it might take for DNSSEC to become a compelling proposition.

Probably worth a read/watch!