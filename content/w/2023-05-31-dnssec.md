---
title: Don't deploy DNSSEC
subtitle: The costs exceed the gains
date: 2023-05-31T08:14:32+12:00
draft: true

categories:
  - Technology
---

On Monday evening and continuing through yesterday the .nz ccTLD became the latest in a long line of victims to suffer from the complexity of the DNSSEC protocol following a mistake during the annual key rollover process.

This broke resolution of several of my domains even though I have not deployed DNSSEC giving me personal motivation to renew my long-standing argument:

**DNSSEC deployment is counter productive. You should leave your domains unsigned.**

The protocol is too complex to operate safely leaving you at risk of security and availability errors. Improvements in the SSL and CA ecosystem means that the threats DNSSEC originally aimed to protect against are now better defended at the application layer instead.


## DNSSEC's Benefits

DNS is a critical component of the Internet. Designed in the very early days of the network when trust was high and security was not a prime consideration the basic protocol offers reasonable availability while providing no guarantees of confidentiality or integrity (thinking in terms of the classic [CIA triad](https://en.wikipedia.org/wiki/Information_security)).

DNSSEC aims to supplement the basic DNS protocol to also provide clients with guarantees that the responses they are receiving are *authentic* (originate from the owner of the domain being resolved, not any other party) and have maintained their *integrity* (contain the original unmodified data from the owner of the domain) in the course of their resolution.

The threat of cache poisoning and spoofing attacks on DNS is very real with plenty of "in the wild" reports of observed attacks. When widely deployed and operating correctly DNSSEC effectively neutralizes these attacks - there is clearly benefit to be gained by adding integrity to the DNS, not only for the improvement to the basic name to IP use-case, but also enabling new use-cases (such as DANE/TLSA) that are only possible when integrity is guaranteed.

DNSSEC has real benefits, but like any benefit achieving those gains comes at a cost.

## DNSSEC's Costs

The primary cost of DNSSEC is increased complexity across the DNS stack from the codebase to the resource requirements and finally the operational and human considerations.

This increased complexity primarily manifests as a reduction in availability due to outages. An exacerbating factor here is the distributed nature of DNS caches and TTLs meaning that even once the underlying trigger for an outage has been fixed, clients may continue to experience availability issues until the TTL on the bad records expires, which often can be up to 24hrs.

## Application layer (web/HTTP) improvements

Historically the state of security at the web application (HTTP) layer has been messy and unclear which increased the value of providing integrity at the DNS layer. SSL certificates were expensive and hard to obtain, the CA ecosystem was a cesspit of poor practices and unclear trust relationships, the appeal of being able to bypass these risks by trusting the integrity of the DNS layer to provide the necessary data to then secure the application layer was compelling.

And yet, despite the compelling potential benefits that widespread DNSSEC deployment promised, what we have observed over the past 10 years instead is that DNSSEC deployment has languished, while the web security ecosystem has flourished and improved in leaps and bounds to the point where an end-user today can have significant confidence that their HTTPS sessions are secure in all dimensions regardless of whether or not DNSSEC is in use. The improvements in web security have eliminated all the benefits DNSSEC provides. A choice to deploy DNSSEC to protect HTTP traffic today is a choice to take on additional costs to reduce your availability without improving security.

## non-HTTP applications

For non-HTTP protocols the story is slightly more complex as there has not been as much evolution and development of the security infrastructure, it is claimed that DNSSEC still has worthwhile benefits to offer here that might justify the costs of deployment.

I think the argument is actually the other direction - the costs of DNSSEC deployment are fixed regardless of how many protocols you are using it to protect, without the benefits of protecting HTTP via DNSSEC these non-HTTP protocols must now bear the full cost of demonstrating that the benefits they can gain outweigh the costs of deployment - keeping in mind that a DNSSEC error is likely to impact an entire zone, causing availability issue for your (typically more valuable) web traffic even if you were only aiming to protect your non-HTTP resources with DNSSEC.

From this perspective, taking the time/effort that would be spent attempting to reliably deploy DNSSEC to protect non-HTTP applications would be much better spent enabling those applications to instead benefit from the SSL ecosystem improvements. MTA-STS provides a clear worked example of the feasibility of this approach, and while the full set of benefits and protections are not yet available, there's significant protection already in place in the ecosystem that you piggy-back on and the collective effort saved from not deploying DNSSEC would go a long way to bringing web-equivalent protections to these additional applications.

## SSL vs alternative crypto root

Buying in to this argument requires accepting the fundamental role of the CA authorities, which as noted above has historically been garbage and not desirable. Many have argued that the DNS trust hierarchy is superior to the CA ecosystem for this reason. I am not convinced.

For one, by nature of being a hierarchy their are significant single points of failure and trust that must be continuously monitored and verified to have confidence in the overall system.

Secondly, the expensse and effort involved in providing that oversight and audit function would be better applied to one ecosystem, rather than two.

## Big providers vs little

Another common argument is that the current DNSSEC costs are simply teething problems that will reduce as the software and tooling matures, or that you can avoid by outsourcing the management and complexity to larger providers to take care of for you.

I don't find these arguments compelling, DNSSEC is already more than 15 years old as a protocol which is plenty of time for improvements and cost reductions in tooling and software to occur. The fact that these improvements have only been piecemeal and deployment rate continues to languish, is a strong refutation of this argument - I see nothing on the horizon that is likely to change or alter this state.

The issue with outsourcing the management and complexity to a trusted piece of software or provider is that its simply delaying the inevitable. You likely can get years of trouble-free operation with this approach until you want to change software or provider at which point you run head-first into the complexity and risks, and worse it's a novel and unfamiliar situation, further increasing the risk of error and the cost of migration. Creating this sort of software/provider lock-in to mitigate the downsides of the DNSSEC protocol is not a desirable outcome.

## Summing up

For the vast majority of domains and use-cases there is simply no net benefit to deploying DNSSEC in 2023. The threats that DNSSEC prevents against are already amply defended by the huge improvements in the SSL ecosystem at the application layer that have occurred over the last 10 years, while the costs and complexities of DNS deployment have at best remained constant, and probably increased. Your time and effort is much better spent on ensuring a robust and well-maintained SSL deployment at your application layer(s), accepting that the DNS layer cannot reliably provide integrity for you and should be treated as untrusted.

Unfortunately, ccTLDs like .nz whose outage triggered this post, remain within the minority of use-cases where DNSSEC deployment cannot be reversed and will have to be maintained given their infrastructural position in the DNS ecosystem. This is a cost these organisations will have to bear going forward. While the full incident report of what went wrong with .nz is not yet available, from the interim report it sounds like there were some missed detection opportunities, and it will be important for InternetNZ to publish a full and comprehensive review so that the learnings and improvements this latest incident can drive can be fully realised both in .nz and by other operators stuck with the unenviable task of trying to safely operate DNSSEC.